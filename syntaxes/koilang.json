{
  "name": "koilang",
  "scopeName": "source.koi",
  "fileTypes": [
    "koi"
  ],
  "patterns": [
    {
      "include": "#command"
    },
    {
      "include": "#comment"
    },
    {
      "include": "#text"
    }
  ],
  "repository": {
    "command": {
      "name": "meta.command.koi",
      "begin": "^\\s*(#)([a-zA-Z_][a-zA-Z0-9_]*)",
      "beginCaptures": {
        "1": {
          "name": "keyword.control.koi"
        },
        "2": {
          "name": "entity.name.function.koi"
        }
      },
      "end": "$",
      "patterns": [
        {
          "include": "#command-argument"
        }
      ]
    },
    "command-argument": {
      "patterns": [
        {
          "include": "#string"
        },
        {
          "include": "#number"
        },
        {
          "include": "#literal"
        },
        {
          "include": "#named-argument"
        },
        {
          "include": "#list"
        },
        {
          "include": "#dictionary"
        }
      ]
    },
    "named-argument": {
      "name": "meta.named-argument.koi",
      "begin": "\\b([a-zA-Z_][a-zA-Z0-9_]*)\\s*(\\()",
      "beginCaptures": {
        "1": {
          "name": "variable.parameter.koi"
        },
        "2": {
          "name": "punctuation.section.group.begin.koi"
        }
      },
      "end": "\\)",
      "endCaptures": {
        "0": {
          "name": "punctuation.section.group.end.koi"
        }
      },
      "patterns": [
        {
          "include": "#argument-list"
        }
      ]
    },
    "list": {
      "name": "meta.list.koi",
      "begin": "\\(",
      "beginCaptures": {
        "0": {
          "name": "punctuation.section.list.begin.koi"
        }
      },
      "end": "\\)",
      "endCaptures": {
        "0": {
          "name": "punctuation.section.list.end.koi"
        }
      },
      "patterns": [
        {
          "include": "#argument-list"
        }
      ]
    },
    "dictionary": {
      "name": "meta.dictionary.koi",
      "begin": "\\b([a-zA-Z_][a-zA-Z0-9_]*)\\s*(\\()",
      "beginCaptures": {
        "1": {
          "name": "variable.other.koi"
        },
        "2": {
          "name": "punctuation.section.dictionary.begin.koi"
        }
      },
      "end": "\\)",
      "endCaptures": {
        "0": {
          "name": "punctuation.section.dictionary.end.koi"
        }
      },
      "patterns": [
        {
          "include": "#dictionary-pair"
        },
        {
          "include": "#argument-list"
        }
      ]
    },
    "dictionary-pair": {
      "match": "\\b([a-zA-Z_][a-zA-Z0-9_]*)\\s*(:)\\s*([^,)}]+)",
      "captures": {
        "1": {
          "name": "variable.other.property.koi"
        },
        "2": {
          "name": "punctuation.separator.dictionary.koi"
        },
        "3": {
          "name": "meta.value.koi",
          "patterns": [
            {
              "include": "#string"
            },
            {
              "include": "#number"
            },
            {
              "include": "#literal"
            }
          ]
        }
      }
    },
    "argument-list": {
      "patterns": [
        {
          "include": "#string"
        },
        {
          "include": "#number"
        },
        {
          "include": "#literal"
        },
        {
          "include": "#dictionary-pair"
        },
        {
          "match": ",",
          "name": "punctuation.separator.argument.koi"
        }
      ]
    },
    "string": {
      "name": "string.quoted.double.koi",
      "begin": "\"",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.string.begin.koi"
        }
      },
      "end": "\"",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.string.end.koi"
        }
      },
      "patterns": [
        {
          "include": "#string-escape"
        }
      ]
    },
    "string-escape": {
      "name": "constant.character.escape.koi",
      "match": "\\\\(n|t|r|b|f|v|a|\\\\|\"|'|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})"
    },
    "number": {
      "patterns": [
        {
          "name": "constant.numeric.float.koi",
          "match": "\\b[0-9]+\\.[0-9]*([eE][+-]?[0-9]+)?\\b"
        },
        {
          "name": "constant.numeric.float.koi",
          "match": "\\b\\.[0-9]+([eE][+-]?[0-9]+)?\\b"
        },
        {
          "name": "constant.numeric.integer.binary.koi",
          "match": "\\b0b[01]+\\b"
        },
        {
          "name": "constant.numeric.integer.hexadecimal.koi",
          "match": "\\b0x[0-9a-fA-F]+\\b"
        },
        {
          "name": "constant.numeric.integer.koi",
          "match": "\\b[0-9]+\\b"
        }
      ]
    },
    "literal": {
      "name": "variable.other.koi",
      "match": "\\b[a-zA-Z_][a-zA-Z0-9_.]*\\b"
    },
    "comment": {
      "name": "comment.line.double-hash.koi",
      "match": "^\\s*##.*$"
    },
    "text": {
      "name": "text.plain.koi",
      "match": "^(?!#).*"
    }
  }
}